![image](https://github.com/user-attachments/assets/3d3b0357-25ad-4dad-9c1a-1ab5aacb9422)
![image](https://github.com/user-attachments/assets/eb9f5b82-6ded-4581-bbc9-e516044bde2a)
![image](https://github.com/user-attachments/assets/4d9983e8-c10d-4241-a11a-ecccd51f9ce6)
![image](https://github.com/user-attachments/assets/eeed174b-2682-4e3a-9657-f84ece54f486)




자동회귀 모델(Autoregressive Model, AR 모델)에 대해 기본 개념부터 심화 내용까지 단계적으로 설명하겠습니다.
1. 기본 개념
자동회귀 모델은 시계열 분석에서 주로 사용되는 통계 모델로, 현재 시점의 값이 이전 시점의 값들에 선형적으로 의존한다고 가정합니다. 즉, "자기 자신(auto)"의 "과거 데이터(regression)"를 활용해 미래를 예측하는 모델입니다. 수학적으로는 다음과 같이 표현됩니다:
X_t = c + \phi_1 X_{t-1} + \phi_2 X_{t-2} + \dots + \phi_p X_{t-p} + \epsilon_t
X_t
: 시점 (t)에서의 값
(c): 상수(절편)
\phi_1, \phi_2, \dots, \phi_p
: 과거 값에 대한 계수(가중치)
X_{t-1}, X_{t-2}, \dots, X_{t-p}
: 과거 (p)개의 시점에서의 값
\epsilon_t
: 백색 잡음(white noise), 평균이 0이고 독립적인 랜덤 오차항
(p): 모델의 차수(order), 즉 몇 개의 과거 데이터를 사용할지 결정
쉽게 말해, AR 모델은 "과거 데이터가 현재 데이터를 설명한다"는 아이디어를 기반으로 합니다. 예를 들어, 주식 가격이나 날씨 데이터를 예측할 때 과거의 패턴을 보고 미래를 추정하는 데 사용할 수 있습니다.
2. 주요 특징
선형성: AR 모델은 과거 값과 현재 값 사이의 관계가 선형이라고 가정합니다.
정상성(Stationarity): AR 모델이 잘 작동하려면 시계열 데이터가 정상성을 가져야 합니다. 즉, 평균과 분산이 시간에 따라 변하지 않아야 합니다. 비정상 시계열의 경우 차분(differencing) 등을 통해 정상화해야 합니다.
차수 (p): (p)는 모델이 얼마나 많은 과거 데이터를 고려할지를 결정합니다. 예를 들어, AR(1)은 바로 직전 데이터만, AR(2)는 직전 두 데이터를 사용합니다.
3. 예시: AR(1) 모델
가장 간단한 AR(1) 모델을 살펴보겠습니다:
X_t = c + \phi_1 X_{t-1} + \epsilon_t
만약 
\phi_1 = 0.8
이라면, 현재 값은 직전 값의 80% 정도 영향을 받고 나머지는 상수와 랜덤 오차로 설명됩니다.
\phi_1
의 절댓값이 1보다 작아야 시계열이 안정적(정상성 유지)입니다. 
\phi_1 \geq 1
이면 값이 폭발적으로 증가하거나 발산할 수 있습니다.
4. 모델 식별과 적합
AR 모델을 실제로 사용하려면 다음 단계를 거칩니다:
데이터 확인: 시계열 데이터가 정상인지 확인 (예: ACF/PACF 그래프 사용).
차수 결정: 부분 자기상관 함수(PACF)를 보고 적절한 (p)를 선택. PACF에서 (p) 이후의 값이 0에 가까워지면 그 (p)가 적합.
모수 추정: 
\phi_1, \phi_2, \dots
와 (c)를 최소제곱법(OLS)이나 최대우도추정(MLE)으로 추정.
모델 검증: 잔차(residual)가 백색 잡음인지 확인.
5. 심화 내용
a. ARIMA와의 관계
AR 모델은 ARIMA(자동회귀누적이동평균) 모델의 일부입니다. ARIMA는 AR(자동회귀), I(차분), MA(이동평균)을 결합한 모델로, 비정상 시계열에도 적용 가능합니다. ARIMA((p, d, q))에서 
d=0, q=0
이면 순수 AR((p)) 모델이 됩니다.
b. 안정성 조건
AR 모델의 안정성은 특성 방정식의 해로 판단됩니다. 예를 들어, AR(2) 모델:
X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \epsilon_t

의 특성 방정식은:
1 - \phi_1 z - \phi_2 z^2 = 0

이 방정식의 근의 절댓값이 모두 1보다 커야(단위 원 밖에 있어야) 시계열이 정상성을 유지합니다.
c. 딥러닝과의 연결
최근에는 RNN(순환신경망)이나 Transformer 같은 딥러닝 모델이 시계열 예측에 사용되지만, 이들은 AR 모델의 "과거 데이터를 활용한다"는 개념을 비선형적으로 확장한 것으로 볼 수 있습니다. 특히 Transformer의 Attention 메커니즘은 과거 데이터에 동적으로 가중치를 부여한다는 점에서 AR 모델과 유사성을 가집니다.
d. 응용
경제학: GDP, 물가 등 거시경제 변수 예측
기상학: 기온, 강수량 예측
신호 처리: 음성 신호나 주파수 분석
6. 한계와 주의점
비선형성: 실제 데이터가 비선형 패턴을 가질 경우 AR 모델은 부정확할 수 있습니다.
외부 변수 무시: AR 모델은 외부 요인(예: 계절성, 외생 변수)을 고려하지 않으므로, ARX나 SARIMA 같은 확장 모델이 필요할 수 있습니다.
과적합: (p)가 너무 크면 데이터에 과적합될 위험이 있습니다.
정리
자동회귀 모델은 과거 데이터를 기반으로 현재와 미래를 예측하는 간단하면서도 강력한 도구입니다. 기본적인 AR(1)부터 복잡한 ARIMA까지 확장 가능하며, 시계열 분석의 기초를 이해하는 데 필수적입니다. 심화 단계에서는 정상성, 특성 방정식, 딥러닝과의 연결 등을 고려하면 더 깊이 이해할 수 있습니다. 추가로 궁금한 점이 있으면 말씀해주세요!
